<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Main ‘kernel’ for baremetal Oak Functions."><title>oak_restricted_kernel - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="oak_restricted_kernel" data-themes="" data-resource-suffix="" data-rustdoc-version="1.77.0-nightly (11f32b73e 2024-01-31)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-4c98445ec4002617.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../oak_restricted_kernel/index.html">oak_restricted_kernel</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#statics">Statics</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../oak_restricted_kernel/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">oak_restricted_kernel</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/oak_restricted_kernel/lib.rs.html#17-518">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Main ‘kernel’ for baremetal Oak Functions.</p>
<p>This code takes care of initializing the x86-64 machine properly and
handing the reins over to the oak_baremetal_runtime. It is in a separate
crate so that we could support different boot protocols (eg Linux boot
protocol or PVH) that require different targets, linker scripts and/or
provide machine information in different data structures.</p>
<p>Bootloaders (and VMMs under them) have to adhere to the following protocol:</p>
<ul>
<li>Enter 64-bit long mode, and set up basic paging – enough to load the
code, as we will set up a full page table in <code>start_kernel</code>.</li>
<li>Implement a <code>#[panic_handler]</code> that delegates to <code>panic()</code> in this
crate.</li>
<li>Call <code>start_kernel</code> from the entry point of the bootloader.</li>
</ul>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="shutdown/index.html" title="mod oak_restricted_kernel::shutdown">shutdown</a></div></li></ul><h2 id="statics" class="section-header">Statics<a href="#statics" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="static" href="static.BASE_L4_PAGE_TABLE.html" title="static oak_restricted_kernel::BASE_L4_PAGE_TABLE">BASE_L4_PAGE_TABLE</a></div><div class="desc docblock-short">Level 4 page table that is free in application space, but has all entries
for kernel space populated. It can be used to create free page tables for
applications, that maintain correct mapping in kernel space.</div></li><li><div class="item-name"><a class="static" href="static.FRAME_ALLOCATOR.html" title="static oak_restricted_kernel::FRAME_ALLOCATOR">FRAME_ALLOCATOR</a></div><div class="desc docblock-short">Allocator for physical memory frames in the system.
We reserve enough room to handle up to 512 GiB of memory, for now.</div></li><li><div class="item-name"><a class="static" href="static.GUEST_HOST_HEAP.html" title="static oak_restricted_kernel::GUEST_HOST_HEAP">GUEST_HOST_HEAP</a></div><div class="desc docblock-short">The allocator for allocating space in the memory area that is shared with
the hypervisor.</div></li><li><div class="item-name"><a class="static" href="static.PAGE_TABLES.html" title="static oak_restricted_kernel::PAGE_TABLES">PAGE_TABLES</a></div><div class="desc docblock-short">Active page tables.</div></li><li><div class="item-name"><a class="static" href="static.VMA_ALLOCATOR.html" title="static oak_restricted_kernel::VMA_ALLOCATOR">VMA_ALLOCATOR</a></div><div class="desc docblock-short">Allocator for long-lived pages in the kernel.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.panic.html" title="fn oak_restricted_kernel::panic">panic</a></div><div class="desc docblock-short">Common panic routine for the kernel. This needs to be wrapped in a
panic_handler function in individual bootloader crates.</div></li><li><div class="item-name"><a class="fn" href="fn.start_kernel.html" title="fn oak_restricted_kernel::start_kernel">start_kernel</a></div><div class="desc docblock-short">Main entry point for the kernel, to be called from bootloader.</div></li></ul></section></div></main></body></html>